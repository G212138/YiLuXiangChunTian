{"version":3,"sources":["assets\\frame\\scripts\\UI\\Panel\\StarCount.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { SoundManager } from './../../Manager/SoundManager';\nimport { Tools } from '../../Utils/Tools';\nimport BaseFrameUI from '../BaseFrameUI';\nimport { EditorManager } from '../../../../game/scripts/Manager/EditorManager';\nimport { ReportManager } from '../../Manager/ReportManager';\nimport { UIHelp } from '../../Utils/UIHelp';\nimport { ConstValue } from '../../../../game/scripts/Data/ConstValue';\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class StarCount extends BaseFrameUI {\n    public static className = 'StarCount';\n\n    private _btn_replay: cc.Node = null;\n    private _sp_like_youxiao: cc.Node = null;\n    private _sp_like_xiaodi: cc.Node = null;\n    private _sp_yuwen: cc.Node = null;\n    private _sp_yingyu: cc.Node = null;\n\n    private audioList: string[] = ['', 'star_good', 'star_great', 'star_perfect'];\n\n    onLoad() {\n        if (this._sp_like_youxiao) {\n            this._sp_like_youxiao.active = false;\n        }\n        if (this._sp_like_xiaodi) {\n            this._sp_like_xiaodi.active = false;\n        }\n        if (this._sp_yuwen) {\n            this._sp_yuwen.active = false;\n        }\n        if (this._sp_yingyu) {\n            this._sp_yingyu.active = false;\n        }\n    }\n\n    /**\n     *\n     * @param isShowReplay 是否显示重玩按钮\n     * @param starNum 星数 (不传参数则从ReportManager里取值)\n     */\n    showStars(isShowReplay?: boolean, starNum?: number): void {\n        let star = 0;\n        if (void 0 === starNum || null === starNum) {\n            star = ReportManager.getStarCount();\n        } else {\n            star = starNum;\n        }\n\n        SoundManager.playEffect(this.audioList[star], false);\n        UIHelp.closeMask();\n\n        if (this._btn_replay) {\n            this._btn_replay.active = isShowReplay;\n        }\n\n        const subject: number = ConstValue.Subject || 1;\n        let spine: sp.Skeleton = null;\n        switch (subject) {\n            case 1:\n                {\n                    const level = EditorManager.getCoursewareLevel();\n                    if (level < 0 || level > 2) {\n                        UIHelp.closeStarCount();\n                        UIHelp.showErrorPanel('coursewareLevel错误，请在EditorManager中设置！');\n                        return;\n                    }\n\n                    if (0 === level) {\n                        spine = this._sp_like_youxiao && this._sp_like_youxiao.getComponent(sp.Skeleton);\n                    } else if (1 === level || 2 === level) {\n                        spine = this._sp_like_xiaodi && this._sp_like_xiaodi.getComponent(sp.Skeleton);\n                    }\n                }\n                break;\n            case 2:\n                {\n                    spine = this._sp_yuwen && this._sp_yuwen.getComponent(sp.Skeleton);\n                }\n                break;\n            case 3:\n                {\n                    spine = this._sp_yingyu && this._sp_yingyu.getComponent(sp.Skeleton);\n                }\n                break;\n        }\n        if (spine) {\n            spine.node.active = true;\n            Tools.playSpine(spine, `in_0${star}`, false, () => {\n                Tools.playSpine(spine, `idle_0${star}`, true);\n            });\n        }\n    }\n}\n"]}