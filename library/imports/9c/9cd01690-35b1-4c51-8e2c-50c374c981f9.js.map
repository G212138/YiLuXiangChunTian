{"version":3,"sources":["assets\\frame\\scripts\\Http\\NetWork.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { ConstValue } from '../../../game/scripts/Data/ConstValue';\nimport { UIManager } from '../Manager/UIManager';\nimport GameMsg from '../SDK/GameMsg';\nimport { UIHelp } from '../Utils/UIHelp';\nexport class NetWorkClass {\n    private static instance: NetWorkClass;\n\n    //判断是否是线上   URL里不加参数则默认为测试环境\n    public readonly isOnlineEnv = this.GetIsOnline() == 'online';\n    //判断是否是pc预加载的协议    URL里不加参数则默认为非预加载\n    public readonly isOwcr = this.GetBPreload();\n    // public readonly BASE = this.isOnlineEnv\n    //     ? 'https://courseware-online.speiyou.com'\n    //     : 'https://ceshi-courseware.speiyou.com';\n    public readonly BASE = this.isOnlineEnv ? 'https://courseware-online.saasp.vdyoo.com' : 'https://ceshi-courseware-online.saasp.vdyoo.com';\n    public readonly COS_URL = this.isOnlineEnv ?\n        'https://classroom-api-online.saasp.vdyoo.com/micro-class/storage/v1/tencent/sts'\n        : 'https://test-class-api-online.saasp.vdyoo.com/micro-class/storage/v1/tencent/sts';\n    public readonly COS_BASE_URL = this.isOnlineEnv ? 'https://micro-class.xuepeiyou.com/' : 'https://micro-class-test.xuepeiyou.com/';\n\n    public readonly GET_QUESTION = this.BASE + '/get';\n    public readonly GET_USER_PROGRESS = this.BASE + '/get/answer';\n    public readonly GET_TITLE = this.BASE + '/get/title';\n    public readonly ADD = this.BASE + '/add';\n    public readonly MODIFY = this.BASE + '/modify';\n    public readonly CLEAR = this.BASE + '/clear';\n\n    public empty: boolean = false; //清理脏数据的开关，在URL里面拼此参数 = true；\n\n    //新课堂参数\n    public userId = null; //用户id\n    public chapterId = null; //直播讲id\n    public coursewareId = null; //题目信息   用于交互游戏自身查题目信息\n    public titleId = null; //交互游戏绑定id   绑定的时候用（监课平台）  学生端不传\n    public bLive = null; //是否是直播\n    public bPreload = null; //是否预加载  （cdn/zip)\n    public env = null; //运行环境（线上/测试）\n    public app = null; //App名称\n    public platform = null; //硬件平台信息（pc/iPad/android/androidPad/web）\n    public channel = null; //使用方(辅导端、学生端、未来黑板、配齐、教研云、……）\n    public browser = null; //浏览器信息（内核及版本）\n    public appVersion = null; //端的版本信息\n    public isTeacher = false; //是否为教师（通过同步的get_role返回的是否为'teacher'）\n    public isSync = false; //是否为同步（通过同步的get_is_sync返回是否为1/true）\n    public isOffline = 0; //是否为离线模式\n    public isMaster = null; //是否是主动发心跳的一方\n    public isSupportKeepPlay = false; //是否支持接着玩重新玩\n\n    public theRequest = null;\n\n    public static getInstance() {\n        if (this.instance == null) {\n            this.instance = new NetWorkClass();\n        }\n        return this.instance;\n    }\n\n    public setIsSync(isSync: boolean) {\n        isSync = isSync == null ? false : isSync;\n        NetWork.isSync = isSync;\n    }\n\n    public setIsTeacher(role: string) {\n        let isTeacher = role == 'teacher';\n        NetWork.isTeacher = isTeacher;\n    }\n\n    public setIsPreload(isPreload: boolean) {\n        isPreload = isPreload == null ? false : isPreload;\n        UIManager.isGameShowing = !isPreload;\n    }\n\n    public setIsMaster(isMaster: boolean) {\n        isMaster = isMaster == null ? false : isMaster;\n        NetWork.isMaster = isMaster;\n    }\n\n    public setIsSupportKeepPlay(isSupportKeepPlay: boolean) {\n        NetWork.isSupportKeepPlay = isSupportKeepPlay;\n        if (!isSupportKeepPlay) {\n            NetWork.isMaster = NetWork.isTeacher;\n        }\n        console.log(`isSupportKeepPlay: ${isSupportKeepPlay}`);\n    }\n\n    /**\n     * 请求网络Post 0成功 1超时\n     * @param url\n     * @param openType\n     * @param contentType\n     * @param callback\n     * @param params\n     */\n    public httpRequest(url: string, openType, contentType, callback = null, params = '') {\n        //------------------离线模式-------------------------\n        if (this.isOffline && url.substring(0, this.GET_QUESTION.length) == this.GET_QUESTION) {\n            GameMsg.recv_json_data((data) => {\n                console.log('recv_json_data:', data);\n                if (callback && data.jsonData.errcode == 0) {\n                    callback(false, data.jsonData);\n                } else {\n                    UIHelp.showErrorPanel(\n                        data.jsonData.errmsg + ',请联系客服！',\n                        '',\n                        '',\n                        '确定',\n                        () => {\n                            this.httpRequest(url, openType, contentType, callback, params);\n                        },\n                        false,\n                    );\n                }\n            });\n            GameMsg.request_json_data({ coursewareId: this.coursewareId });\n            return;\n        }\n\n        if (ConstValue.IS_TEACHER) {\n            if (!this.titleId) {\n                //教师端没有titleId的情况\n                UIHelp.showErrorPanel('URL参数错误,缺少titleId,请联系技术人员！', '', '', '确定');\n                return;\n            }\n        } else {\n            //新课堂学生端  判断所有参数\n            if (\n                !ConstValue.IS_TEACHER &&\n                (!this.userId || !this.coursewareId || !this.env || !this.app || !this.channel || !this.browser)\n            ) {\n                GameMsg.URLError(this.theRequest);\n                UIHelp.showErrorPanel('URL参数错误,请联系客服！', '', '', '确定');\n                return;\n            }\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(openType, url);\n        xhr.timeout = 10000;\n        xhr.setRequestHeader('Content-Type', contentType);\n        xhr.withCredentials = true;\n\n        //回调\n        xhr.onreadystatechange = () => {\n            console.log(\n                'httpRequest rsp status',\n                xhr.status,\n                '        xhr.readyState',\n                xhr.readyState,\n                '        xhr.responseText',\n                xhr.responseText,\n            );\n            if (xhr.readyState == 4 && xhr.status >= 200 && xhr.status <= 400) {\n                let response = JSON.parse(xhr.responseText);\n                if (callback && response.errcode == 0) {\n                    callback(false, response);\n                } else {\n                    GameMsg.httpError(response.errmsg);\n                    if (ConstValue.IS_EDITIONS) {\n                        UIHelp.showErrorPanel(\n                            response.errmsg + ',请联系客服！',\n                            '',\n                            '',\n                            '确定',\n                            () => {\n                                this.httpRequest(url, openType, contentType, callback, params);\n                            },\n                            false,\n                        );\n                    }\n                }\n            }\n        };\n\n        //超时回调\n        xhr.ontimeout = (event) => {\n            GameMsg.httpTimeOut('网络不佳，请稍后重试');\n            if (ConstValue.IS_EDITIONS) {\n                UIHelp.showErrorPanel(\n                    '网络不佳，请稍后重试',\n                    '',\n                    '若重新连接无效，请联系客服',\n                    '重新连接',\n                    () => {\n                        this.httpRequest(url, openType, contentType, callback, params);\n                    },\n                    true,\n                );\n            }\n            console.log('httpRequest timeout');\n            callback && callback(true, null);\n        };\n\n        //出错\n        xhr.onerror = (error) => {\n            if (ConstValue.IS_EDITIONS) {\n                UIHelp.showErrorPanel(\n                    '网络出错，请稍后重试',\n                    '若重新连接无效，请联系客服',\n                    '',\n                    '重新连接',\n                    () => {\n                        this.httpRequest(url, openType, contentType, callback, params);\n                    },\n                    true,\n                );\n            }\n            console.log('httpRequest error');\n            callback && callback(true, null);\n        };\n\n        xhr.send(params);\n    }\n\n    /**\n     * 获取url参数\n     */\n    public GetRequest() {\n        if (this.theRequest != null) {\n            return this.theRequest;\n        }\n        this.theRequest = new Object();\n        var url = location.search; //获取url中\"?\"符后的字串\n\n        if (url.indexOf('?') != -1) {\n            var str = url.substr(1);\n            var strs = str.split('&');\n            for (var i = 0; i < strs.length; i++) {\n                this.theRequest[strs[i].split('=')[0]] = decodeURIComponent(strs[i].split('=')[1]);\n            }\n        }\n\n        //新课堂url必需参数\n        this.userId = this.theRequest['userId'];\n        this.chapterId = this.theRequest['chapterId'];\n        this.coursewareId = this.theRequest['coursewareId'];\n        this.titleId = this.theRequest['titleId'];\n        this.bLive = this.theRequest['bLive'];\n        this.bPreload = this.theRequest['bPreload'];\n        this.env = this.theRequest['env'];\n        this.app = this.theRequest['app'];\n        this.platform = this.theRequest['platform'];\n        this.channel = this.theRequest['channel'];\n        this.browser = this.theRequest['browser'];\n        this.appVersion = this.theRequest['appVersion'];\n        this.empty = this.theRequest['empty'];\n        this.isOffline = parseInt(this.theRequest['isOffline']); //离线模式\n\n        return this.theRequest;\n    }\n\n    public GetBPreload() {\n        let BPreload = 0;\n        if (this.GetRequest()['bPreload']) {\n            BPreload = this.GetRequest()['bPreload'];\n        }\n        return BPreload;\n    }\n\n    public GetIsOnline() {\n        let isOnline = 'test';\n        if (this.GetRequest()['env']) {\n            isOnline = this.GetRequest()['env'];\n        }\n        return isOnline;\n    }\n}\n\nexport const NetWork = NetWorkClass.getInstance();\n"]}